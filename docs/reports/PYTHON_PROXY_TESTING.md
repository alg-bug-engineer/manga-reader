# ğŸ§ª Python ä»£ç†æœåŠ¡å™¨ - æµ‹è¯•æŒ‡å—

æœ¬æŒ‡å—æä¾›äº†å®Œæ•´çš„æµ‹è¯•æ–¹æ¡ˆï¼Œç¡®ä¿ Python ä»£ç†æœåŠ¡å™¨æ­£å¸¸å·¥ä½œã€‚

## ğŸ“‹ å¿«é€Ÿæµ‹è¯•

### 1ï¸âƒ£ ä½¿ç”¨ Python æµ‹è¯•è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
python3 test-proxy-server.py
```

è¿™ä¼šè‡ªåŠ¨æµ‹è¯•ï¼š
- å¥åº·æ£€æŸ¥
- è„šæœ¬ç”Ÿæˆ
- å›¾ç‰‡ç”Ÿæˆ

---

## ğŸ” æ‰‹åŠ¨æµ‹è¯•

### æµ‹è¯• 1: å¥åº·æ£€æŸ¥

```bash
curl http://127.0.0.1:3001/health
```

**é¢„æœŸè¾“å‡ºï¼š**
```json
{
  "status": "ok",
  "client_initialized": true,
  "has_api_key": true
}
```

**å¦‚æœå¤±è´¥ï¼š**
- æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å¯åŠ¨ï¼š`./start-proxy-server.sh`
- æ£€æŸ¥ç«¯å£å ç”¨ï¼š`lsof -i :3001`

---

### æµ‹è¯• 2: è„šæœ¬ç”Ÿæˆ

```bash
curl -X POST http://127.0.0.1:3001/api/generate-script \
  -H "Content-Type: application/json" \
  -d '{
    "concept": "RAG",
    "model": "gemini-2.0-flash-exp"
  }'
```

**é¢„æœŸè¾“å‡ºï¼š**
```json
{
  "success": true,
  "panels": [
    {
      "panelNumber": 1,
      "sceneDescription": "...",
      "dialogue": "..."
    }
  ],
  "totalPanels": 24
}
```

**è€—æ—¶ï¼š** 10-30 ç§’

---

### æµ‹è¯• 3: å›¾ç‰‡ç”Ÿæˆ

```bash
curl -X POST http://127.0.0.1:3001/api/generate-image \
  -H "Content-Type: application/json" \
  -d '{
    "panel": {
      "panelNumber": 1,
      "sceneDescription": "A cute robot with a screen face explaining AI to a grumpy cat",
      "dialogue": "Let me explain how AI works!"
    },
    "style": "peach",
    "model": "gemini-2.0-flash-exp"
  }'
```

**é¢„æœŸè¾“å‡ºï¼š**
```json
{
  "success": true,
  "imageData": "base64_encoded_image_data..."
}
```

**è€—æ—¶ï¼š** 10-20 ç§’

---

## ğŸŒ Node.js é›†æˆæµ‹è¯•

### æ­¥éª¤ 1: å¯åŠ¨æ‰€æœ‰æœåŠ¡

**ç»ˆç«¯ 1 - Python æœåŠ¡å™¨ï¼š**
```bash
./start-proxy-server.sh
```

**ç»ˆç«¯ 2 - Node.js åº”ç”¨ï¼š**
```bash
npm run dev
```

### æ­¥éª¤ 2: è®¿é—®åº”ç”¨

```
http://localhost:3000/generate-comic
```

### æ­¥éª¤ 3: æ£€æŸ¥çŠ¶æ€æŒ‡ç¤ºå™¨

é¡µé¢å³ä¸Šè§’åº”è¯¥æ˜¾ç¤ºï¼š
- ğŸŸ¢ **Python æœåŠ¡å°±ç»ª** (ç»¿è‰²åœ†ç‚¹ï¼Œè„‰å†²åŠ¨ç”»)

å¦‚æœæ˜¾ç¤ºçº¢è‰²ï¼š
- ğŸ”´ **Python æœåŠ¡ç¦»çº¿** - è¯·æ£€æŸ¥ Python æœåŠ¡å™¨æ˜¯å¦å¯åŠ¨

### æ­¥éª¤ 4: å®Œæ•´æµç¨‹æµ‹è¯•

1. **è¾“å…¥æ¦‚å¿µ**
   - è¾“å…¥ï¼šRAG
   - é€‰æ‹©é£æ ¼ï¼šèœœæ¡ƒç°ç°
   - ç‚¹å‡»ï¼šå¼€å§‹ç”Ÿæˆæ¼«ç”»

2. **è§‚å¯Ÿè„šæœ¬ç”Ÿæˆ**
   - ç­‰å¾… 10-30 ç§’
   - åº”è¯¥çœ‹åˆ°ç”Ÿæˆçš„è„šæœ¬å†…å®¹ï¼ˆ20-30 æ ¼ï¼‰

3. **è§‚å¯Ÿå›¾ç‰‡ç”Ÿæˆ**
   - è‡ªåŠ¨è¿›å…¥å›¾ç‰‡ç”Ÿæˆ
   - è¿›åº¦æ¡ï¼š1/24 â†’ 2/24 â†’ ... â†’ 24/24
   - æ¯å¼ å›¾ç‰‡çº¦ 10-20 ç§’
   - æ€»è€—æ—¶çº¦ 5-10 åˆ†é’Ÿ

4. **æµ‹è¯•é‡æ–°ç”Ÿæˆ**
   - åœ¨å®¡æ ¸é˜¶æ®µï¼Œç‚¹å‡»ä»»æ„å›¾ç‰‡çš„"é‡æ–°ç”Ÿæˆ"
   - è§‚å¯Ÿæ˜¯å¦æˆåŠŸé‡æ–°ç”Ÿæˆ

5. **æµ‹è¯•å‘å¸ƒ**
   - å¡«å†™æ ‡é¢˜ã€ä½œè€…ã€æ ‡ç­¾
   - ç‚¹å‡»å‘å¸ƒ
   - åº”è¯¥è·³è½¬åˆ°é¦–é¡µ

---

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: è¿æ¥è¢«æ‹’ç»

**é”™è¯¯ï¼š**
```
Error: connect ECONNREFUSED 127.0.0.1:3001
```

**åŸå› ï¼š** Python æœåŠ¡å™¨æœªå¯åŠ¨

**è§£å†³ï¼š**
```bash
# å¯åŠ¨æœåŠ¡å™¨
./start-proxy-server.sh

# éªŒè¯
curl http://127.0.0.1:3001/health
```

---

### é—®é¢˜ 2: è¯·æ±‚è¶…æ—¶

**é”™è¯¯ï¼š**
```
Error: è¯·æ±‚è¶…æ—¶ (120ç§’)
```

**åŸå› ï¼š**
- ç½‘ç»œæ…¢
- API å“åº”æ…¢
- ä»£ç†é—®é¢˜

**è§£å†³ï¼š**

1. æ£€æŸ¥ç³»ç»Ÿä»£ç†ï¼š
   ```bash
   echo $HTTP_PROXY
   echo $HTTPS_PROXY
   ```

2. æµ‹è¯•ä»£ç†ï¼š
   ```bash
   curl -x http://127.0.0.1:7890 https://www.google.com
   ```

3. å¢åŠ è¶…æ—¶ï¼š
   ```bash
   # .env.local
   GEMINI_REQUEST_TIMEOUT=180000
   ```

---

### é—®é¢˜ 3: API Key æœªè®¾ç½®

**é”™è¯¯ï¼š**
```json
{
  "has_api_key": false
}
```

**è§£å†³ï¼š**
```bash
# æ£€æŸ¥
cat .env.local | grep GEMINI_API_KEY

# å¦‚æœæ²¡æœ‰ï¼Œè®¾ç½®
./setup-gemini.sh

# é‡å¯æœåŠ¡å™¨
```

---

### é—®é¢˜ 4: æ¨¡å—æœªæ‰¾åˆ°

**é”™è¯¯ï¼š**
```
ModuleNotFoundError: No module named 'flask'
```

**è§£å†³ï¼š**
```bash
# é‡æ–°å®‰è£…
./install-proxy.sh

# æˆ–æ‰‹åŠ¨å®‰è£…
source .venv/bin/activate
uv pip install -r requirements.txt
```

---

## ğŸ“Š æ€§èƒ½åŸºå‡†

### é¢„æœŸè€—æ—¶

| æ“ä½œ | å¹³å‡æ—¶é—´ | èŒƒå›´ |
|------|---------|------|
| å¥åº·æ£€æŸ¥ | 0.3ç§’ | 0.1-0.5ç§’ |
| è„šæœ¬ç”Ÿæˆ | 20ç§’ | 10-60ç§’ |
| å•å¼ å›¾ç‰‡ | 15ç§’ | 10-40ç§’ |
| å®Œæ•´æ¼«ç”»(24æ ¼) | 6åˆ†é’Ÿ | 3-15åˆ†é’Ÿ |

### èµ„æºå ç”¨

```
Python ä»£ç†æœåŠ¡å™¨ï¼š
- å†…å­˜: 100-200 MB
- CPU: 5-15% (ç”Ÿæˆæ—¶)

Node.js åº”ç”¨ï¼š
- å†…å­˜: 200-400 MB
- CPU: 5-10%
```

---

## âœ… æµ‹è¯•æ£€æŸ¥è¡¨

éƒ¨ç½²å‰ç¡®è®¤ï¼š

- [ ] Python æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ
- [ ] å¥åº·æ£€æŸ¥é€šè¿‡ (`has_api_key: true`)
- [ ] è„šæœ¬ç”Ÿæˆæµ‹è¯•é€šè¿‡
- [ ] å›¾ç‰‡ç”Ÿæˆæµ‹è¯•é€šè¿‡
- [ ] å‰ç«¯æ˜¾ç¤º "Python æœåŠ¡å°±ç»ª"
- [ ] å®Œæ•´æµç¨‹æµ‹è¯•é€šè¿‡
- [ ] é‡æ–°ç”ŸæˆåŠŸèƒ½æ­£å¸¸
- [ ] é”™è¯¯å¤„ç†æ­£å¸¸

---

## ğŸš€ æµ‹è¯•å‘½ä»¤æ±‡æ€»

```bash
# 1. æµ‹è¯• Python æœåŠ¡å™¨
python3 test-proxy-server.py

# 2. å¿«é€Ÿå¥åº·æ£€æŸ¥
curl http://127.0.0.1:3001/health

# 3. æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :3001

# 4. æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—
# (åœ¨è¿è¡Œ start-proxy-server.sh çš„ç»ˆç«¯æŸ¥çœ‹)

# 5. æµ‹è¯• Node.js åº”ç”¨
curl http://localhost:3000

# 6. æµ‹è¯•å®Œæ•´ API
curl -X POST http://127.0.0.1:3001/api/generate-script \
  -H "Content-Type: application/json" \
  -d '{"concept": "RAG"}'
```

---

*æ›´æ–°æ—¶é—´ï¼š2025-12-31*
*ç‰ˆæœ¬ï¼šv1.0.0*
